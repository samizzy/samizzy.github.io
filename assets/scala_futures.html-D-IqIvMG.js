import{_ as c,c as r,b as s,a as p,e,w as o,d as a,r as l,o as u}from"./app-Bguh2_f1.js";const d="/augmented-reality-education-futre.jpg",k={},m={class:"table-of-contents"},h={href:"https://www.scala-lang.org/api/2.11.12/index.html#scala.concurrent.Future",target:"_blank",rel:"noopener noreferrer"},v={class:"custom-container tip"},g={href:"https://scastie.scala-lang.org/",target:"_blank",rel:"noopener noreferrer"},f={href:"https://github.com/samizzy/scala-futures-basics",target:"_blank",rel:"noopener noreferrer"};function b(w,n){const t=l("router-link"),i=l("ExternalLinkIcon");return u(),r("div",null,[n[16]||(n[16]=s("h2",{id:"towards-the-future",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#towards-the-future"},[s("span",null,"Towards the Future")])],-1)),n[17]||(n[17]=s("p",null,"What are futures? Is this a concept only limited to select few from scala? Will it affect your future? We are going to find out about all this and more. Keep reading.",-1)),n[18]||(n[18]=s("img",{src:d},null,-1)),s("nav",m,[s("ul",null,[s("li",null,[e(t,{to:"#towards-the-future"},{default:o(()=>n[0]||(n[0]=[a("Towards the Future")])),_:1,__:[0]})]),s("li",null,[e(t,{to:"#so-what-are-futures"},{default:o(()=>n[1]||(n[1]=[a("So what are Futures?")])),_:1,__:[1]})]),s("li",null,[e(t,{to:"#need-for-futures"},{default:o(()=>n[2]||(n[2]=[a("Need for Futures")])),_:1,__:[2]})]),s("li",null,[e(t,{to:"#let-s-do-some-coding"},{default:o(()=>n[3]||(n[3]=[a("Let's do some Coding!")])),_:1,__:[3]}),s("ul",null,[s("li",null,[e(t,{to:"#scala-version"},{default:o(()=>n[4]||(n[4]=[a("Scala Version")])),_:1,__:[4]})]),s("li",null,[e(t,{to:"#basic-starter-code"},{default:o(()=>n[5]||(n[5]=[a("Basic Starter Code")])),_:1,__:[5]})]),s("li",null,[e(t,{to:"#future-chaining"},{default:o(()=>n[6]||(n[6]=[a("Future Chaining")])),_:1,__:[6]})])])]),s("li",null,[e(t,{to:"#code-samples"},{default:o(()=>n[7]||(n[7]=[a("Code Samples")])),_:1,__:[7]})])])]),n[19]||(n[19]=p('<h2 id="so-what-are-futures" tabindex="-1"><a class="header-anchor" href="#so-what-are-futures"><span>So what are Futures?</span></a></h2><p>It is a <em>model</em> of parallel programming, there are other models such actor model. It is not limited to scala, there are similar apis in java, javascript and other languages as well.</p><p>An informal definition would be: Future is like a lazy person(me). If you give it some task to do, it doesnt do it immediately instead it tells you, <em>&quot;Yeah I am busy rite now.. will do it later but here is a <strong>gift</strong> you can use instead&quot;</em>. This <strong>gift</strong> is very <em>evil</em> as it is another future but this one contains our result. The catch is, if you try to open it, there is no guarantee you will find anything inside.</p><p>So instead of opening it, you work with the <strong>gift</strong> itself. You might ask, how can I work with the <strong>gift</strong> itself? At some point I will need to open the <strong>gift</strong> rite? (You can)</p><p>We will do exactly those things, so keep reading 😃</p><h2 id="need-for-futures" tabindex="-1"><a class="header-anchor" href="#need-for-futures"><span>Need for Futures</span></a></h2><p><em>Parallel programming</em>? People have been parallel programming before right? Java people will say they have java.lang.Thread, why would they bother about futures?</p><p>The answer is that Futures are a <strong>wrapper</strong> over threads, they are a higher level programming api. They provide us many convenient abilities which helps the developer to focus on their programming logic instead of thread creation and their <em>interaction</em>. We will see the advantages ahead.</p><div class="custom-container warning"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8v4"></path><path d="M12 16h.01"></path></g></svg><p class="custom-container-title">Note</p><p>Using futures freely for trivial calculations will just result in more time, as most of the time will go in thread context switch, you ideally want to use futures on tasks that usually take time like IO or some heavy processing but for the sake of demo we have chosen simple tasks.</p></div><h2 id="let-s-do-some-coding" tabindex="-1"><a class="header-anchor" href="#let-s-do-some-coding"><span>Let&#39;s do some Coding!</span></a></h2><h3 id="scala-version" tabindex="-1"><a class="header-anchor" href="#scala-version"><span>Scala Version</span></a></h3>',11)),s("p",null,[n[9]||(n[9]=a("I am using scala version 2.11.12 and you can find the scala doc for futures ")),s("a",h,[n[8]||(n[8]=a("here")),e(i)])]),n[20]||(n[20]=p(`<h3 id="basic-starter-code" tabindex="-1"><a class="header-anchor" href="#basic-starter-code"><span>Basic Starter Code</span></a></h3><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>Future</span>
<span class="line"><span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>ExecutionContext<span class="token punctuation">.</span>Implicits<span class="token punctuation">.</span>_</span>
<span class="line"></span>
<span class="line"><span class="token keyword">object</span> Main <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">val</span> numString <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">val</span> future <span class="token operator">=</span> Future<span class="token punctuation">{</span> <span class="token comment">// &lt;-- Future code block </span></span>
<span class="line">       println<span class="token punctuation">(</span>stringToInt<span class="token punctuation">(</span>numString<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">//converts a integer to string</span></span>
<span class="line">  <span class="token keyword">def</span> stringToInt<span class="token punctuation">(</span>numString<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Int</span> <span class="token operator">=</span> numString<span class="token punctuation">.</span>toInt</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So what we have done here?</p><p>We have defined a function <code>stringToInt()</code> that takes a string as input and converts it to integer, we are not concerned with the string not being a valid number for now.</p><p>For now, we want to print the number returned. Now we wrap the call to this <code>println</code> function using <code>Future{..code block..}</code>.</p><div class="custom-container tip"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Scala</p><p>In scala every expression returns something and in above case, it returns a <code>Future[Unit]</code> as println returns Unit.</p></div><p>So yeah we are done now! This code will print the value 123 in a separate thread! Now lets execute this code.</p><p>Wait... the main function exits and you dont see anything printed on the console?</p><p>The reason is the future is executed on a separate thread, bt before the separate thread could do anything the main thread exits the main function and the JVM shutsdown! So lets add this line at the end to see the output to wait till the future finishes and dont forget to import <code>import scala.concurrent.duration.Duration</code></p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">Await<span class="token punctuation">.</span>result<span class="token punctuation">(</span>future<span class="token punctuation">,</span> Duration<span class="token punctuation">.</span>Inf<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And now you will see <code>123</code> on console. 🎉</p>`,11)),s("div",v,[n[13]||(n[13]=p('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Tip</p>',2)),s("p",null,[n[11]||(n[11]=a("You can run all the examples online on ")),s("a",g,[n[10]||(n[10]=a("scastie")),e(i)]),n[12]||(n[12]=a(" and you dont have to write inside main, you can directly start coding away! 😍"))])]),n[21]||(n[21]=p(`<h4 id="understanding-the-code" tabindex="-1"><a class="header-anchor" href="#understanding-the-code"><span>Understanding the Code</span></a></h4><p>We skipped over a lot of things before, so lets look at it in a bit more detail.</p><p>For using <code>Future{}</code> we need to import <strong><code>import scala.concurrent.ExecutionContext.Implicits._</code></strong> otherwise you will get an error <strong><code>&quot;No implicits found for parameter: ExecutionContext&quot;</code></strong>.</p><p>So implicity you are passing a execution context everytime when you are using <code>Future{}</code>, without this it wont compile.</p><p>So what is an ExecutionContext? For simplicity let&#39;s consider its just a thread pool and Futures require you to pass it everytime. <strong>YES EVERYTIME</strong> and that is why it is convenient to make a it a implicit argument. 😃</p><p>For our example we are using the pre-existing global execution present in <strong><code>scala.concurrent.ExecutionContext.Implicits</code></strong>. It utilises the fork join pool present since java 8.</p><p>The above example was too simple, let&#39;s try to do something a little more practical.</p><h3 id="future-chaining" tabindex="-1"><a class="header-anchor" href="#future-chaining"><span>Future Chaining</span></a></h3><p>The main advantage of future in scala is that you can chain series of functions one after the other. This makes it really powerfull and for achieving this there are several methods we can use.</p><div class="custom-container tip"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Gift</p><p>This is what I meant earlier when I said we <em>use</em> the <strong>gift</strong> itself.</p></div><h4 id="map-and-flatmap" tabindex="-1"><a class="header-anchor" href="#map-and-flatmap"><span>map and flatMap</span></a></h4><p>Lets look at the below examples for map and flatMap</p><p>Suppose you a have source of strings coming from somewhere and each string is alphanumeric, more precisely for our example there is buried a number within characters. You are tasked with extracting the number and printing. You look at the problem and devise a strategy.</p><p>The strategy is:</p><ul><li>Get string</li><li>Replace all english characters</li><li>Trim all the space</li><li>Convert to integer</li><li>Print result</li></ul><p>and in that <strong>sequence</strong>.</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>samizzy<span class="token punctuation">.</span>scala<span class="token punctuation">.</span>basic<span class="token punctuation">.</span>map_flatmap</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>ExecutionContext<span class="token punctuation">.</span>Implicits<span class="token punctuation">.</span>_</span>
<span class="line"><span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>duration<span class="token punctuation">.</span></span>Duration</span>
<span class="line"><span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token punctuation">{</span>Await<span class="token punctuation">,</span> Future<span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">object</span> Main <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">//Example for map</span></span>
<span class="line">  <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">val</span> future <span class="token operator">=</span> </span>
<span class="line">                Future<span class="token punctuation">(</span>getString<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                  map<span class="token punctuation">(</span>sanitize<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                  map<span class="token punctuation">(</span>strip<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                  map<span class="token punctuation">(</span>stringToInt<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                  map<span class="token punctuation">(</span>println<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    Await<span class="token punctuation">.</span>result<span class="token punctuation">(</span>future<span class="token punctuation">,</span> Duration<span class="token punctuation">.</span>Inf<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> getString<span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token string">&quot; 123 hey there&quot;</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> sanitize<span class="token punctuation">(</span>alphaNumeric<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> alphaNumeric<span class="token punctuation">.</span>replaceAll<span class="token punctuation">(</span><span class="token string">&quot;[a-zA-Z]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> strip<span class="token punctuation">(</span>numString<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> numString<span class="token punctuation">.</span>trim</span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> stringToInt<span class="token punctuation">(</span>numString<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> numString<span class="token punctuation">.</span>toInt</span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Each step in the strategy is made into a function and we have chained the functions using <code>map</code> method present on Future. <em>Cool rite?</em> 😄.</p><div class="custom-container tip"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Benefit</p><p>Low level stuff such as waiting for the thread to finish, then pass the result of the this thread to the new thread is taken careof by the futures api</p></div><p>In each <code>map</code> method you will get the output of the previous method and you can then perform any operation on them, you are basically being spoon fed the inputs.</p><p>It&#39;s important to take a look at the signature of <strong>map</strong>,</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token comment">//T type corresponds to type the current future holds and</span></span>
<span class="line"><span class="token comment">//S type corresponds to type that map shall convert to.</span></span>
<span class="line"><span class="token keyword">def</span> map<span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token punctuation">(</span>fn<span class="token operator">:</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> S <span class="token punctuation">)</span><span class="token operator">:</span> Future<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>It takes a function that accepts argument of type <code>T</code> then transforms it into type <code>S</code>, the <code>map</code> method itself returns type of <code>Future[S]</code>, so basically the passed function has the responsibility of doing transformation and then map will return a Future of that transformation!</p><p>Now there maybe a scenario where we are told next that we will get another integer and now we have to add this integer to the extracted integer.</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">    <span class="token keyword">val</span> toAdd<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> getToAdd</span>
<span class="line">    <span class="token keyword">val</span> future <span class="token operator">=</span> </span>
<span class="line">                Future<span class="token punctuation">(</span>getString<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>sanitize<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>strip<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>stringToInt<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>_ <span class="token operator">+</span> toAdd<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>println<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    Await<span class="token punctuation">.</span>result<span class="token punctuation">(</span>future<span class="token punctuation">,</span> Duration<span class="token punctuation">.</span>Inf<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> getToAdd<span class="token operator">:</span><span class="token builtin">Int</span> <span class="token operator">=</span> <span class="token number">20</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So you say, <strong>&quot;Hold my beer&quot;</strong>.</p><p>You rollup your sleeves and then you smash in the above solution, but then there&#39;s a <strong>twist</strong>, you&#39;re told the number to add is not constant and can randomly change, and that it is being fetched from an external source, so you always need to fetch the latest value.</p><p>Another thing is some other developer has already written the code for adding a number to the latest number returning Future, so you will receive <code>Future[Int]</code> instead of <code>Int</code>.</p><p>But how do you chain a future from another source? To save us from this hell, <code>flatMap</code> comes to the rescue,</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"></span>
<span class="line">    <span class="token keyword">val</span> future <span class="token operator">=</span> </span>
<span class="line">                Future<span class="token punctuation">(</span>getString<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>sanitize<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>strip<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>stringToInt<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                flatMap<span class="token punctuation">(</span>getAdded<span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token comment">// getAdded returns Future[Int] and flatMap also returns Future[Int]</span></span>
<span class="line">                map<span class="token punctuation">(</span>println<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    Await<span class="token punctuation">.</span>result<span class="token punctuation">(</span>future<span class="token punctuation">,</span> Duration<span class="token punctuation">.</span>Inf<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> getAdded<span class="token punctuation">(</span>num<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span>Future<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> Future<span class="token punctuation">(</span>Random<span class="token punctuation">.</span>nextInt<span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span> <span class="token operator">+</span> num<span class="token punctuation">)</span> <span class="token comment">//imagine this is from an external source</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If we take a look at the signature of <strong>flatMap</strong>,</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token comment">//flatMap  takes an function that itself returns Future</span></span>
<span class="line"><span class="token keyword">def</span> flatMap<span class="token punctuation">[</span>S<span class="token punctuation">]</span><span class="token punctuation">(</span>fn<span class="token operator">:</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> Future<span class="token punctuation">[</span>S<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token operator">:</span> Future<span class="token punctuation">[</span>S<span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>it takes a function that accepts an argument of type <code>T</code> (similar to map) but this function returns a <code>Future[S]</code> as compared to <code>S</code> in map.</p><p>So flatMap are useful when you have a function that itself returns future and not plain object.</p><h4 id="zip" tabindex="-1"><a class="header-anchor" href="#zip"><span>zip</span></a></h4><p>But lets say the developer had only implemented the functionality to fetch the number and not add &amp; return, then we can use the zip method. It adds the result of current future (the one on which .zip is called) with another future that is passed as an argument to zip. When I say add result, i mean it delivers the result as a tuple of both results. Below is the code.</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">    <span class="token keyword">val</span> future <span class="token operator">=</span> </span>
<span class="line">                Future<span class="token punctuation">(</span>getString<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>sanitize<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>strip<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>stringToInt<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                zip<span class="token punctuation">(</span>getNum<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>tuple<span class="token keyword">=&gt;</span> tuple<span class="token punctuation">.</span>_1 <span class="token operator">+</span> tuple<span class="token punctuation">.</span>_2<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                map<span class="token punctuation">(</span>println<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    Await<span class="token punctuation">.</span>result<span class="token punctuation">(</span>future<span class="token punctuation">,</span> Duration<span class="token punctuation">.</span>Inf<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> getNum<span class="token operator">:</span> Future<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> Future<span class="token punctuation">(</span>Random<span class="token punctuation">.</span>nextInt<span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Actually we could have achieved the same thing with <strong>flatMap</strong>, it&#39;s not hard to figure out so i&#39;ll leave it upto you guys.</p><p>So thats all for now! Thanks for reading! We&#39;ll take a look at the rest of the methods some other time. Hope you feel a little more like a future gangsta now 😎</p><h2 id="code-samples" tabindex="-1"><a class="header-anchor" href="#code-samples"><span>Code Samples</span></a></h2>`,40)),s("p",null,[n[15]||(n[15]=a("All code on this page is available on this ")),s("a",f,[n[14]||(n[14]=a("GitHub repository")),e(i)])])])}const x=c(k,[["render",b]]),S=JSON.parse(`{"path":"/blogs/technology/2020/May/scala_futures.html","title":"Taking a look at Scala futures","lang":"en-US","frontmatter":{"title":"Taking a look at Scala futures","author":"Samrat Saha","date":"2020-05-17T00:00:00.000Z","tags":["beginner","intermediate","scala","futures"],"categories":["technology"]},"headers":[{"level":2,"title":"Towards the Future","slug":"towards-the-future","link":"#towards-the-future","children":[]},{"level":2,"title":"So what are Futures?","slug":"so-what-are-futures","link":"#so-what-are-futures","children":[]},{"level":2,"title":"Need for Futures","slug":"need-for-futures","link":"#need-for-futures","children":[]},{"level":2,"title":"Let's do some Coding!","slug":"let-s-do-some-coding","link":"#let-s-do-some-coding","children":[{"level":3,"title":"Scala Version","slug":"scala-version","link":"#scala-version","children":[]},{"level":3,"title":"Basic Starter Code","slug":"basic-starter-code","link":"#basic-starter-code","children":[]},{"level":3,"title":"Future Chaining","slug":"future-chaining","link":"#future-chaining","children":[]}]},{"level":2,"title":"Code Samples","slug":"code-samples","link":"#code-samples","children":[]}],"git":{"createdTime":1589725570000,"updatedTime":1750112300000,"contributors":[{"name":"Samrat Saha","email":"samizzy18@gmail.com","commits":1}]},"filePathRelative":"blogs/technology/2020/May/scala_futures.md"}`);export{x as comp,S as data};
