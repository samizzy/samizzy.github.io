import{_ as t,c,b as o,a as l,d as s,e,w as p,r as i,o as u}from"./app--Ei2UsaZ.js";const r={};function k(d,n){const a=i("RouteLink");return u(),c("div",null,[o("p",null,[n[2]||(n[2]=s("We have learned about ")),e(a,{to:"/blogs/technology/2020/July/java_8_streams.html#what-is-a-lambda"},{default:p(()=>n[0]||(n[0]=[s("Lambdas")])),_:1,__:[0]}),n[3]||(n[3]=s(" and ")),e(a,{to:"/blogs/technology/2020/July/java_8_features.html#function-interface"},{default:p(()=>n[1]||(n[1]=[s("Functional Interfaces")])),_:1,__:[1]}),n[4]||(n[4]=s(" before. Now that we have got the concepts clear, we will see how we can modularize our code using them."))]),n[5]||(n[5]=l(`<h2 id="using-functions-inside-of-methods" tabindex="-1"><a class="header-anchor" href="#using-functions-inside-of-methods"><span>Using Functions inside of Methods</span></a></h2><p>You will always come across methods that are just <em>toooo</em> long. It makes understanding the code really difficult and wakes up the criminal inside you and you just hope that you dont know the person who wrote it otherwise there <em>will</em> be carnage.</p><p>Imagine you have a problem, you are given a user name and you have to find other details of the user. You have to check the cache first and then the database to avoid latency. Also some details of the user have to be taken from different services. Ofcourse you also have to do some validation, ie does the userName exist, length of the userName, userName is not empty etc.</p><p>Looking at some code will give you a better idea. Getting the User and UserWithDetails class out of the way first.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line">    <span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">Stirng</span> userName<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">this</span><span class="token punctuation">.</span>userName <span class="token operator">=</span> userName<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">class</span> <span class="token class-name">UserWithDetails</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">User</span> user<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> thumbnail<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> online<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">long</span> lastSeen<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">public</span> <span class="token class-name">UserWithDetails</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> thumbnail<span class="token punctuation">,</span> <span class="token keyword">boolean</span> online<span class="token punctuation">,</span> <span class="token keyword">long</span> lastSeen<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// imagine all the associations here..</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="long-code-example" tabindex="-1"><a class="header-anchor" href="#long-code-example"><span>Long Code example</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line">    <span class="token comment">//Lets Assume the Cache, Database, Detail Service and all the exceptions classes exist</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">Cache</span> cache1 <span class="token operator">=</span> <span class="token function">initCache1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">Cache</span> cache2 <span class="token operator">=</span> <span class="token function">initCache2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">Database</span> db  <span class="token operator">=</span> <span class="token function">initDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">DetailService</span> detailService <span class="token operator">=</span> <span class="token function">getDetailService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//Do validation, if fail throw exception</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>userName<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EmptyUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        </span>
<span class="line"></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>userName<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">255</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InvalidUserName</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//Check cache1 and cache2</span></span>
<span class="line">        <span class="token class-name">UserWithDetails</span> userDetails <span class="token operator">=</span> cache1<span class="token punctuation">.</span><span class="token function">getUserDetails</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>userDetails <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">            userDetails <span class="token operator">=</span> cache2<span class="token punctuation">.</span><span class="token function">getUserDetails</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//If user found from cache then return, otherwise search in db</span></span>
<span class="line">        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>userDetails <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> </span>
<span class="line">            <span class="token keyword">return</span> userDetails<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">else</span> user <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//If still not found throw Exception</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UserDoesNotExist</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">//if user exist then get user with details</span></span>
<span class="line">        userDetails <span class="token operator">=</span> detailService<span class="token punctuation">.</span><span class="token function">getUserDetails</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">//store in cache</span></span>
<span class="line">        cache1<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        cache2<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>userDetails<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//Now we are ready to return</span></span>
<span class="line">        <span class="token keyword">return</span> userDetails<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span>    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To be honest the example above is not really long or complex to read but this method sums up the problem nicely that we are trying to solve.</p><p><strong>Problems:</strong></p><ul><li>Numeruous validation of userName. You have to carefully read each line to know when it starts and when it ends. Here we have only 2 but usually we would have many such validations and then it gets harder to read.</li><li>No code <em>reuse</em>. The part of getting userDetails from cache1 and cache2 is repeated.</li><li>The code is full of dealing with null values.</li><li>We are doing several different things inside the method, and many of those thing could be isolated which would increase the cohesiveness.</li></ul><h3 id="code-with-private-functions-example" tabindex="-1"><a class="header-anchor" href="#code-with-private-functions-example"><span>Code with private functions example</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line">    <span class="token keyword">private</span> <span class="token class-name">Cache</span> cache1 <span class="token operator">=</span> <span class="token function">initCache1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">Cache</span> cache2 <span class="token operator">=</span> <span class="token function">initCache2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">Database</span> db  <span class="token operator">=</span> <span class="token function">initDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">DetailService</span> detailService <span class="token operator">=</span> <span class="token function">getDetailService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Cache</span><span class="token punctuation">&gt;</span></span> cacheList <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>cache1<span class="token punctuation">,</span> cache2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">//Do validation, if fail throw exception</span></span>
<span class="line">        <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Optional</span><span class="token punctuation">&lt;</span><span class="token class-name">Exception</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> validateUserName <span class="token operator">=</span></span>
<span class="line">                <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EmptyUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InvalidUserName</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token function">throwExIfPresent</span><span class="token punctuation">(</span>validateUserName<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//Check cache1 and cache2</span></span>
<span class="line">        <span class="token class-name">Option</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserWithDetails</span><span class="token punctuation">&gt;</span></span> userFromCache <span class="token operator">=</span> </span>
<span class="line">            cacheList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>cache <span class="token operator">-&gt;</span> cache<span class="token punctuation">.</span><span class="token function">getUserDetails</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token operator">::</span><span class="token function">nonNull</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">//If user found from cache then return</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>userFromCache<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> userFromCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//otherwise search in Db, if user found then get user details from detailService</span></span>
<span class="line">        <span class="token class-name">Option</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserWithDetails</span><span class="token punctuation">&gt;</span></span> userFromService <span class="token operator">=</span> </span>
<span class="line">            <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token operator">::</span><span class="token function">nonNull</span><span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                <span class="token function">map</span><span class="token punctuation">(</span>detailService<span class="token operator">::</span><span class="token function">getUserDetails</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">//If details found, store in cache</span></span>
<span class="line">        userFromService<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span>usd <span class="token operator">-&gt;</span> cacheList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>cache <span class="token operator">-&gt;</span> cache<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>usd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token comment">//If details found return otherwise throw exception.</span></span>
<span class="line">        <span class="token keyword">return</span> userFromService<span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">UserDoesNotExist</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Wrote this outside as this could be reused in other methods too .. in a real application this would make sense.</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">throwExIfPresent</span><span class="token punctuation">(</span><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Exception</span><span class="token punctuation">&gt;</span></span> exOpt<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> ex<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We have addressed all the problems I mentioned earlier.</p><h2 id="using-closures" tabindex="-1"><a class="header-anchor" href="#using-closures"><span>Using Closures</span></a></h2><div class="custom-container tip"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">Closure</p><p>A Function that uses variables outside of it&#39;s scope is called a Closure.</p></div><p>Do not worry if you dont understand, it will be clear later.</p><p>First lets look at the problem.</p><p>You receive a request to process a order like on an ecommerce website. This order will go through various stages and will take a bit of time. You want your client to be able to view the progress so you save the details in a database, then your client can query and know the status.</p><p>In below examples we are not concerned with the actual processing steps but just the part with saving to a database.</p><p>Getting some common code out of the way first.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line">    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Stage</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token constant">CUSTOMER_CREDIT_CHECKING</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token constant">CUSTOMER_CREDIT_DONE</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token constant">ITEM_QUANTITY_CHECKING</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token constant">ITEM_QUANTITY_DONE</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token constant">ITEM_DELIVERABILITY_CHECKING</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token constant">ITEM_DELIVERABILITY_DONE</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line">    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderState</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Customer</span> customer<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Order</span> order<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Long</span> startTime<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Long</span> lastUpdateTime<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Stage</span> stage<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">//constructor and all..</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="traditional-way" tabindex="-1"><a class="header-anchor" href="#traditional-way"><span>Traditional Way</span></a></h3><p>We just need to focus on the processRequest method.</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">private</span> <span class="token class-name">Datbase</span> db <span class="token operator">=</span> <span class="token function">initDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">CreditService</span> creditService <span class="token operator">=</span> <span class="token function">initCS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">ProductAvailabilityService</span> paService <span class="token operator">=</span> <span class="token function">initPAS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">ProductDeliverableService</span> pdSerivce <span class="token operator">=</span> <span class="token function">initPDS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">Request</span> request<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Order</span> order <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">Customer</span> customer <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getCustomer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">Long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">saveToDb</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> <span class="token constant">CUSTOMER_CREDIT_CHECKING</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//Do logic with creditService</span></span>
<span class="line">    <span class="token function">saveToDb</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> <span class="token constant">CUSTOMER_CREDIT_DONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">saveToDb</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> <span class="token constant">ITEM_QUANTITY_CHECKING</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//Do logic with paService</span></span>
<span class="line">    <span class="token function">saveToDb</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> <span class="token constant">ITEM_QUANTITY_DONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">saveToDb</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> <span class="token constant">ITEM_DELIVERABILITY_CHECKING</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//Do logic with pdService</span></span>
<span class="line">    <span class="token function">saveToDb</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> <span class="token constant">ITEM_DELIVERABILITY_DONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">saveToDb</span><span class="token punctuation">(</span><span class="token class-name">Customer</span> customer<span class="token punctuation">,</span> <span class="token class-name">Order</span> order<span class="token punctuation">,</span> <span class="token class-name">Long</span> startTime<span class="token punctuation">,</span> <span class="token class-name">Stage</span> stage<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Long</span> lastUpdateTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    db<span class="token punctuation">.</span><span class="token function">saveOrderState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OrderState</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> lastUpdateTime<span class="token punctuation">,</span> stage<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>See how inside processRequest, when calling saveToDb we are providing all the arguments to the method each time.</p><p><strong>This can can create problems:</strong></p><ul><li>Imagine adding a new field, then you would have to change every call of saveToDb</li><li>This method is very small and we have skipped writing the business logic, but ppl can make mistakes when calling the method, usually calling with wrong arguments.</li><li>Though one can say code is reused, when we know we can write closures, then reusability then isnt that high.</li></ul><h3 id="with-closures" tabindex="-1"><a class="header-anchor" href="#with-closures"><span>With closures</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token keyword">private</span> <span class="token class-name">Datbase</span> db <span class="token operator">=</span> <span class="token function">initDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">CreditService</span> creditService <span class="token operator">=</span> <span class="token function">initCS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">ProductAvailabilityService</span> paService <span class="token operator">=</span> <span class="token function">initPAS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">private</span> <span class="token class-name">ProductDeliverableService</span> pdSerivce <span class="token operator">=</span> <span class="token function">initPDS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">Request</span> request<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Order</span> order <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">Customer</span> customer <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getCustomer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">Long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Stage</span><span class="token punctuation">&gt;</span></span> save <span class="token operator">=</span> </span>
<span class="line">        stage <span class="token operator">-&gt;</span> db<span class="token punctuation">.</span><span class="token function">saveOrderState</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> order<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stage<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    save<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token constant">CUSTOMER_CREDIT_CHECKING</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//Do logic with creditService</span></span>
<span class="line">    save<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token constant">CUSTOMER_CREDIT_DONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    save<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token constant">ITEM_QUANTITY_CHECKING</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//Do logic with paService</span></span>
<span class="line">    save<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token constant">ITEM_QUANTITY_DONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    save<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token constant">ITEM_DELIVERABILITY_CHECKING</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//Do logic with pdService</span></span>
<span class="line">    save<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token constant">ITEM_DELIVERABILITY_DONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>I want to shout TADA! like a magician does after performing a trick! </p><p>Its such a small change but look how good the code looks now.</p><h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion"><span>Conclusion</span></a></h2><p>So that&#39;s it, these simple and small changes can make a large difference when writing code. I&#39;ll update this post when I find other useful tricks.</p><p>Thanks for reading!</p>`,35))])}const v=t(r,[["render",k]]),h=JSON.parse('{"path":"/blogs/technology/2020/August/java_functional_practises.html","title":"How to modularize your Java 8 code","lang":"en-US","frontmatter":{"title":"How to modularize your Java 8 code","author":"Samrat Saha","date":"2020-08-15T00:00:00.000Z","tags":["beginner","java"],"categories":["technology"],"publish":true},"headers":[{"level":2,"title":"Using Functions inside of Methods","slug":"using-functions-inside-of-methods","link":"#using-functions-inside-of-methods","children":[{"level":3,"title":"Long Code example","slug":"long-code-example","link":"#long-code-example","children":[]},{"level":3,"title":"Code with private functions example","slug":"code-with-private-functions-example","link":"#code-with-private-functions-example","children":[]}]},{"level":2,"title":"Using Closures","slug":"using-closures","link":"#using-closures","children":[{"level":3,"title":"Traditional Way","slug":"traditional-way","link":"#traditional-way","children":[]},{"level":3,"title":"With closures","slug":"with-closures","link":"#with-closures","children":[]}]},{"level":2,"title":"Conclusion","slug":"conclusion","link":"#conclusion","children":[]}],"git":{"createdTime":1597510861000,"updatedTime":1750152176000,"contributors":[{"name":"Samrat Saha","email":"samizzy18@gmail.com","commits":2}]},"filePathRelative":"blogs/technology/2020/August/java_functional_practises.md"}');export{v as comp,h as data};
